<!--
  Title: index.html
  Summary: babylon.js driver html file for tutorials and the bjs_test video
  Owner: Zachary Fout
  Version: 0.1.1
  Created: 06/20/2016
  Last Modified: 06/22/2016
  Notes: recreated torus, added animation to transition between blue and green,
  collapsed multiple calls to keys array push function into a single call
-->
<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html" charset="utf-8" />
    <title>Babylon - Getting Started</title>
    <!-- link to the latest version of babylon -->
    <script src="./js/babylon.2.4.js"></script>
    <script src="./js/hand.1.2.js"></script>
    <script src="./js/cannon.2.4.js"></script>
    <script src="./js/oimo.2.4.js"></script>
    <style>
      html, body {
        overflow: hidden;
        width: 100%;
        height: 100%;
        margin: 0;
        padding: 0;
      } #renderCanvas {
        width: 100%;
        height: 100%;
        touch-action: none;
      }
    </style>
  </head>
  <body>
    <canvas id="renderCanvas"></canvas>
    <script>
      window.addEventListener('DOMContentLoaded', function() {
        // get a reference to the canvas DOM element
        var canvas = document.getElementById('renderCanvas');

        // load the Babylon 3D engine
        var engine = new BABYLON.Engine(canvas, true);

        // create and return a babylon scene
        var createScene = function () {
	        var scene = new BABYLON.Scene(engine);

          //Create a hemispheric light pointed at the sky
          var light = new BABYLON.HemisphericLight("Hemi", new BABYLON.Vector3(0, 1, 0), scene);

          //Create an Arc Rotate Camera and attach it to the canvas
          var camera = new BABYLON.ArcRotateCamera("Camera", 0, 0.8, 20, BABYLON.Vector3.Zero(), scene);
          camera.attachControl(canvas, true);

          // create a torus mesh and a texture material
          var torus = BABYLON.Mesh.CreateTorus("torus", 5, 3, 20, scene, true);
          var torusMaterial = new BABYLON.StandardMaterial("torusTexture", scene);

          // define the color transitions of the torus
          var blueTorus = new BABYLON.Color3(0.008, 0, 0.729);
          var turqoisTorus = new BABYLON.Color3(0.047, 0.518, 0.31);
          var greenTorus = new BABYLON.Color3(0.075, 0.898, 0.035);

          // set the initial color of the torus
          torusMaterial.diffuseColor = blueTorus;
          torus.material = torusMaterial;

          // define the animation object
          var torusColorAnimation = new BABYLON.Animation(
        	  "torusColor", "material.diffuseColor", 30,
        	  BABYLON.Animation.ANIMATIONTYPE_COLOR3,
        	  BABYLON.Animation.ANIMATIONLOOPMODE_CYCLE);

          // create an animation keys array and add keys
          var keys = [];
          keys.push(
            { frame: 0, value: blueTorus },
            { frame: 50, value: turqoisTorus },
            { frame: 100, value: greenTorus },
            { frame: 150, value: turqoisTorus },
            { frame: 200, value: blueTorus }
          );

          // set the animation keys for the animation reference
          torusColorAnimation.setKeys(keys);

          // add the new animation to the torus mesh
          torus.animations.push(torusColorAnimation);

          // start the animation
          scene.beginAnimation(torus, 0, 200, true);

          return scene;
        };

        // call the createScene function
        var scene = createScene();

        // run the render loop
        engine.runRenderLoop(function() {
          scene.render();
        });

        // event handler for canvas/window resizing
        window.addEventListener('resize', function() {
          engine.resize();
        });
      });
    </script>
  </body>
</html>
